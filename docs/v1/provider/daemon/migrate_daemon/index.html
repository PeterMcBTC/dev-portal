<!doctype html>
<html class="docs-version-1.0.0" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="TDEX Network Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="TDEX Network Blog Atom Feed"><title data-react-helmet="true">Migrate a daemon to v1 | TDEX Network</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://dev.tdex.network/img/tdex-og-image.png"><meta data-react-helmet="true" name="twitter:image" content="https://dev.tdex.network/img/tdex-og-image.png"><meta data-react-helmet="true" property="og:url" content="https://dev.tdex.network/docs/v1/provider/daemon/migrate_daemon"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="1.0.0"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-1.0.0"><meta data-react-helmet="true" property="og:title" content="Migrate a daemon to v1 | TDEX Network"><meta data-react-helmet="true" name="description" content="If you are already running a v0 liquidity provider, you can bump its version to the newest v1 by using the brand new service called tdex-migration. This service requires the unlocking password and helps you translating the data stored in the old daemon&#x27;s datadir to the format required by the newest version v1 and by the Ocean wallet."><meta data-react-helmet="true" property="og:description" content="If you are already running a v0 liquidity provider, you can bump its version to the newest v1 by using the brand new service called tdex-migration. This service requires the unlocking password and helps you translating the data stored in the old daemon&#x27;s datadir to the format required by the newest version v1 and by the Ocean wallet."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://dev.tdex.network/docs/v1/provider/daemon/migrate_daemon"><link data-react-helmet="true" rel="alternate" href="https://dev.tdex.network/docs/v1/provider/daemon/migrate_daemon" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://dev.tdex.network/docs/v1/provider/daemon/migrate_daemon" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.1c87e427.css">
<link rel="preload" href="/assets/js/runtime~main.49f14e07.js" as="script">
<link rel="preload" href="/assets/js/main.6f0a87f6.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/tdex-logo.png" alt="TDEX logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/tdex-logo.png" alt="TDEX logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Developer Portal</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/v1/">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs/v1/">1.0.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/latest/provider/daemon/migrate_daemon">latest</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/v1/provider/daemon/migrate_daemon">1.0.0</a></li><li><a class="dropdown__link" href="/docs/v0/">0.9.1</a></li></ul></div><a href="https://github.com/tdex-network" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/v1/">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Specifications</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Trader</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Liquidity Provider</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/intro">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Daemon</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/daemon/overview">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Getting Started</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/daemon/init_daemon">Init &amp; Unlock</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/v1/provider/daemon/migrate_daemon">Migrate a daemon to v1</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/daemon/fee_account">Fee Account</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/daemon/market_account">Market Account</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/daemon/fee_fragmenter_account">Fee Fragmenter Account</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/daemon/market_fragmenter_account">Market Fragmenter Account</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/daemon/feeder">Price feeder</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/daemon/webhooks">Webhooks</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v1/provider/registry">Registry</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 1.0.0</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Migrate a daemon to v1</h1></header><p>If you are already running a <em>v0</em> liquidity provider, you can bump its version to the newest <em>v1</em> by using the brand new service called <code>tdex-migration</code>. This service requires the unlocking password and helps you translating the data stored in the old daemon&#x27;s datadir to the format required by the newest version <em>v1</em> and by the Ocean wallet.</p><p>You can either use the released binary, or you can build it yourself by cloning the official tdex-daemon repository and run <code>make build-migration</code> - you&#x27;ll find it in the <em>build/</em> folder -.
Instead, if you serve your daemon as a dockerized solution, you can just pull the latest official image with <code>docker pull ghcr.io/tdex-network/tdexd:latest</code> and use the <code>tdex-migration</code> binary packed together with <code>tdexd</code> (daemon) and <code>tdex</code> (cli).</p><p>The service can be configured by the mean of the fowllowing flags:</p><ul><li><code>--password</code> (required) the daemon&#x27;s password used to unlock the storage for reading all the data that is going to be translated</li><li><code>--v0-datadir</code> (optional) the path of the <em>v0</em> daemons&#x27; datadir to be migrated. Defaults to <code>~/.tdex-daemon</code> for Linux and <code>~/Library/Application\ Support/Tdex-daemon</code> for MacOS</li><li><code>--v1-datadir</code> (optional) the path of the <em>v1</em> daemon&#x27;s datadir as result of the migration. Defaults to <code>~/.tdex-daemon</code> for Linux and <code>~/Library/Application\ Support/Tdex-daemon</code> for MacOS in order to overwrite the old datadir</li><li><code>--ocean-datadir</code> (optional) the path of the Ocean wallet&#x27;s datadir as result of the migration. Defaults to <code>~/.oceand</code> for Linux and <code>~/Library/Application\ Support/Oceand</code> for MacOS</li><li><code>--no-backup</code> (optional) skip creating a <code>.tar.gz</code> compressed archive of the old datadir, included in the new one otherwise. When disabling the backup, the old datadir is just deleted and forever lost. Defaults to <code>false</code></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="migrate-standalone-daemon"></a>Migrate standalone daemon<a class="hash-link" href="#migrate-standalone-daemon" title="Direct link to heading">#</a></h2><p>Move the <code>tdex-migration</code> binary to your <em>PATH</em> (eg. <code>/usr/local/bin</code>), then start the migration with:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Start migration with default configuration </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tdex-migration --password password</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start migration with default configuration and no backup of the old datadir</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tdex-migration --password password --no-backup</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start migration with custom source folder and default targets</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tdex-migration --password password --v0-datadir path/to/datadir</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start migration with default source folder and custom targets</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tdex-migration --password password --v1-datadir path/to/datadir --ocean-datadir path/to/ocean-datadir</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Once the migration is complete, you should first start the Ocean wallet and then the daemon as shown <a href="/docs/v1/provider/daemon/getting_started/run_standalone">here</a> - don&#x27;t forget to change the path for their datadirs with <code>export OCEAN_DATADIR=path/to/wallet/datadir</code> and <code>export TDEX_DATADIR=/path/to/daemon/datadir</code> if you don&#x27;t use the defaults.</p><p>Keep in mind that you must run your ocean wallet configured with <code>OCEAN_DB_TYPE=badger</code> when you migrate your daemon. You can&#x27;t select a different storage unless you choose to move to a brand new wallet, or restore the same one by loosing the whole trading history though.</p><p>##Â Migrate dockerized daemon</p><p>Once you pulled down the latest daemon&#x27;s docker images, take care of making a backup of your daemon&#x27;s datadir manually, then you can run the migration by overriding its entrypoint with:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ docker run --rm --entrypoint </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;tdex-migration&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --volume /path/to/datadir:/home/tdex/.tdex-daemon </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ghcr.io/tdex-network/tdexd:latest </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --password password </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --ocean-datadir /home/tdex/.tdex-daemon/oceand </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --no-backup</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>With this command your provider&#x27;s datadir will be overwritten and will also include the datadir of the Ocean wallet.
The backup of the datadir is intentionally skipped because that operation might cause problems with the migration depending on the machine on which docker is installed. To prevent any problem in advance, we strongly suggest you to manually backup the <em>v0</em> datadir and skip this step.</p><p>Once the migration is complete, you should move the ocean datadir out of the daemon&#x27;s one, then start the wallet and the daemon as hown <a href="/docs/v1/provider/daemon/getting_started/run_docker">here</a>.</p><p>Keep in mind that you must run your ocean wallet configured with <code>OCEAN_DB_TYPE=badger</code> when you migrate your daemon. You can&#x27;t select a different storage unless you choose to move to a brand new wallet, or restore the same one by loosing the whole trading history though.</p><p>Wonderful! You just bumped your provider to the latest version and you can now see a lot of new cool stuff, like the new commands for managing the <a href="/docs/v1/provider/daemon/fee_account"><em>fee account</em></a> or the <a href="/docs/v1/provider/daemon/market_account"><em>markets</em></a>, or even how to handle the newly introduced <a href="/docs/v1/provider/daemon/feeder"><em>price feeds</em></a> or the changes made to the <a href="/docs/v1/provider/daemon/webhooks">webhooks</a>. You can surf the documentation to know more of every features of the new <em>v1</em> provider!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/tdex-network/dev-portal/edit/master/versioned_docs/version-1.0.0/provider/daemon/migrate_daemon.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/v1/provider/daemon/init_daemon"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Init &amp; Unlock</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/v1/provider/daemon/fee_account"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Fee Account Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#migrate-standalone-daemon" class="table-of-contents__link">Migrate standalone daemon</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">DOCS</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/latest/specs/index">Specifications</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/latest/trader/intro">Trader</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/latest/provider/intro">Liquidity Provider</a></li></ul></div><div class="col footer__col"><div class="footer__title">COMMUNITY</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/tdexnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">MORE</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/tdex-network" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 TDEX Network. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.49f14e07.js"></script>
<script src="/assets/js/main.6f0a87f6.js"></script>
</body>
</html>